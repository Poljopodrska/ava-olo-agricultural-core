<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="v2.5.0">
    <title>AVA OLO Business Dashboard</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/shared/design-system/assets/favicon.svg">
    
    <!-- Design System CSS -->
    <link rel="stylesheet" href="/shared/design-system/css/design-system.css">
    <link rel="stylesheet" href="/shared/design-system/css/typography.css">
    <link rel="stylesheet" href="/shared/design-system/css/components.css">
    
    <style>
        /* Page-specific styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-xl);
        }
        
        .metric-card {
            background: var(--ava-white);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
        }
        
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .metric-icon {
            width: 48px;
            height: 48px;
            background: var(--ava-olive);
            color: var(--ava-white);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: var(--space-md);
        }
        
        .metric-value {
            font-size: 36px;
            font-weight: var(--font-weight-bold);
            color: var(--ava-black);
            margin: var(--space-sm) 0;
        }
        
        .metric-label {
            font-size: var(--font-size-min);
            color: var(--ava-gray-600);
            margin-bottom: var(--space-xs);
        }
        
        .metric-change {
            font-size: var(--font-size-min);
            font-weight: var(--font-weight-medium);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        .metric-change.positive {
            color: var(--ava-success);
        }
        
        .metric-change.negative {
            color: var(--ava-error);
        }
        
        .debug-info {
            background: var(--ava-gray-100);
            border: 2px solid var(--ava-olive);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .debug-info h2 {
            color: var(--ava-olive);
            margin-bottom: var(--space-md);
        }
        
        .debug-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }
        
        .debug-item {
            background: var(--ava-white);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
        }
        
        .debug-label {
            font-size: var(--font-size-min);
            color: var(--ava-gray-600);
            font-weight: var(--font-weight-medium);
        }
        
        .debug-value {
            font-size: var(--font-size-lead);
            color: var(--ava-black);
            font-weight: var(--font-weight-bold);
        }
        
        /* Charts placeholder */
        .chart-container {
            background: var(--ava-white);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-md);
            margin-top: var(--space-xl);
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--ava-gray-400);
        }
        
        /* Footer */
        .dashboard-footer {
            margin-top: var(--space-xxl);
            padding: var(--space-lg) 0;
            border-top: 1px solid var(--ava-gray-200);
            text-align: center;
            color: var(--ava-gray-600);
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-value {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="ava-header">
        <div class="logo">
            <img src="/shared/design-system/assets/logo-white.svg" alt="AVA OLO">
        </div>
        <nav>
            <a href="/">Home</a>
            <a href="/business-dashboard">Business</a>
            <a href="/monitoring">Monitoring</a>
            <a href="/database">Database</a>
        </nav>
        <div class="version-display">v2.5.0</div>
    </header>
    
    <!-- Main Content -->
    <main class="container" style="padding-top: var(--space-xl);">
        <h1>AVA OLO Business Dashboard</h1>
        <p class="lead">Real-time agricultural intelligence and business metrics</p>
        
        <!-- Debug Information Box -->
        <div class="debug-info">
            <h2>üîç System Status</h2>
            <div class="debug-grid">
                <div class="debug-item">
                    <div class="debug-label">Environment</div>
                    <div class="debug-value">Production</div>
                </div>
                <div class="debug-item">
                    <div class="debug-label">Database</div>
                    <div class="debug-value">Connected</div>
                </div>
                <div class="debug-item">
                    <div class="debug-label">API Version</div>
                    <div class="debug-value">v2.5.0</div>
                </div>
                <div class="debug-item">
                    <div class="debug-label">Last Updated</div>
                    <div class="debug-value" id="last-updated">Loading...</div>
                </div>
            </div>
        </div>
        
        <!-- Metrics Grid -->
        <div class="dashboard-grid">
            <!-- Total Farmers -->
            <div class="metric-card">
                <div class="metric-icon">üë®‚Äçüåæ</div>
                <div class="metric-label">Total Farmers</div>
                <div class="metric-value" id="total-farmers">Loading...</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>12% from last month</span>
                </div>
            </div>
            
            <!-- Total Hectares -->
            <div class="metric-card">
                <div class="metric-icon">üåæ</div>
                <div class="metric-label">Total Hectares</div>
                <div class="metric-value" id="total-hectares">Loading...</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>8% from last month</span>
                </div>
            </div>
            
            <!-- Active Conversations -->
            <div class="metric-card">
                <div class="metric-icon">üí¨</div>
                <div class="metric-label">Active Conversations</div>
                <div class="metric-value" id="active-conversations">Loading...</div>
                <div class="metric-change negative">
                    <span>‚Üì</span>
                    <span>3% from yesterday</span>
                </div>
            </div>
            
            <!-- System Health -->
            <div class="metric-card">
                <div class="metric-icon">üîß</div>
                <div class="metric-label">System Health</div>
                <div class="metric-value" style="font-size: 24px; color: var(--ava-success);">Operational</div>
                <div class="metric-change" style="color: var(--ava-gray-600);">
                    <span>99.9% uptime</span>
                </div>
            </div>
        </div>
        
        <!-- Charts Section -->
        <div class="chart-container">
            <p>Charts and analytics will be displayed here</p>
        </div>
        
        <!-- Footer -->
        <footer class="dashboard-footer">
            <p>AVA OLO Agricultural Intelligence System - Constitutional Design</p>
            <p class="small">¬© 2025 AVA OLO. Professional agricultural solutions for Croatian farmers.</p>
        </footer>
    </main>
    
    <!-- Accessibility JavaScript -->
    <script src="/shared/design-system/js/accessibility.js"></script>
    
    <!-- Dashboard-specific JavaScript -->
    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Update timestamp
            const updateTimestamp = () => {
                const now = new Date();
                document.getElementById('last-updated').textContent = now.toLocaleString('en-US', {
                    dateStyle: 'short',
                    timeStyle: 'medium'
                });
            };
            updateTimestamp();
            setInterval(updateTimestamp, 60000); // Update every minute
            
            // Fetch real data from API
            fetchDashboardData();
        });
        
        // Fetch dashboard data
        async function fetchDashboardData() {
            try {
                // Try to fetch from API
                const response = await fetch('/api/stats/overview');
                if (response.ok) {
                    const data = await response.json();
                    updateMetrics(data);
                } else {
                    // Use default values if API fails
                    useDefaultValues();
                }
            } catch (error) {
                console.error('Failed to fetch dashboard data:', error);
                useDefaultValues();
            }
        }
        
        // Update metrics with real data
        function updateMetrics(data) {
            document.getElementById('total-farmers').textContent = data.total_farmers || 4;
            document.getElementById('total-hectares').textContent = data.total_hectares || '52.3';
            document.getElementById('active-conversations').textContent = data.total_conversations || 127;
        }
        
        // Use default values
        function useDefaultValues() {
            document.getElementById('total-farmers').textContent = '4';
            document.getElementById('total-hectares').textContent = '52.3';
            document.getElementById('active-conversations').textContent = '127';
        }
    </script>
</body>
</html>